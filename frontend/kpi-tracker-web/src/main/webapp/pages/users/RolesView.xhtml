<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/pages/californiatemplate/template.xhtml">

    <ui:define name="title">Manage Roles</ui:define>
    <ui:define name="viewname">Roles</ui:define>

    <ui:define name="content">
        <style>

            .roles-container {
                padding: 20px;
                border-radius: 10px;
                margin: 20px;
            }

            .roles-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 30px;
                background-color: rgba(255, 255, 255, 0.9);
                padding: 10px;
                border-radius: 8px;
            }

            .roles-title {
                font-size: 24px;
                font-weight: bold;
                color: #333;
            }

            .search-section {
                display: flex;
                gap: 10px;
                align-items: center;
            }

            .roles-grid {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
                gap: 20px;
                margin-top: 20px;
            }

            .role-card {
                background: white;
                border: 1px solid #e0e0e0;
                border-radius: 8px;
                padding: 20px;
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                transition: transform 0.2s, box-shadow 0.2s;
            }

            .role-card:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 8px rgba(0,0,0,0.15);
            }

            .role-name { font-size: 18px; font-weight: bold; color: #2c3e50; margin-bottom: 8px; }
            .role-description { color: #666; margin-bottom: 15px; font-size: 14px; line-height: 1.4; }
            .role-permissions { display: flex; align-items: center; gap: 5px; margin-bottom: 15px; font-size: 14px; color: #5a9fd4; }
            .permissions-count { background: #5a9fd4; color: white; padding: 2px 8px; border-radius: 12px; font-size: 12px; }
            .role-actions { display: flex; gap: 10px; justify-content: flex-end; }
            .add-role-section { text-align: center; margin: 40px 0; }

            .add-role-card {
                background: rgba(255, 255, 255, 0.8);
                border: 2px dashed #5a9fd4;
                border-radius: 8px;
                padding: 40px;
                max-width: 300px;
                margin: 0 auto;
                transition: all 0.3s ease;
            }
            .add-role-card:hover { background: rgba(255, 255, 255, 0.95); border-color: #4a8bc2; }
            .add-role-text { color: #666; margin-bottom: 15px; font-style: italic; }
            .empty-state { text-align: center; padding: 60px 20px; color: #666; background-color: rgba(255, 255, 255, 0.9); border-radius: 8px; }
            .empty-state-icon { font-size: 48px; color: #ccc; margin-bottom: 20px; }
        </style>

        <h:form id="rolesViewForm">
            <div class="roles-container">
                <p:growl id="growl" showDetail="true" />

                <!-- Header Section -->
                <div class="roles-header">
                    <div class="roles-title">Roles &amp; Permissions</div>
                    <div class="search-section">
                        <p:inputText id="searchTerm" required="false"
                                     placeholder="Search for roles..."
                                     value="#{rolesView.searchTerm}"
                                     styleClass="p-mr-2">
                            <p:ajax event="keyup" update="rolesGridPanel"
                                    listener="#{rolesView.reloadFilterReset()}" />
                        </p:inputText>
                    </div>
                </div>

                <!-- Roles Grid -->
                <h:panelGroup id="rolesGridPanel" layout="block">
                    <h:panelGroup rendered="#{not empty rolesView.dataModels}">
                        <div class="roles-grid">
                            <ui:repeat value="#{rolesView.dataModels}" var="model">
                                <div class="role-card">
                                    <div class="role-name">#{model.name}</div>
                                    <div class="role-description">#{model.description}</div>
                                    <div class="role-permissions">
                                        <span>Permissions:</span>
                                        <span class="permissions-count">#{model.permissions.size()}</span>
                                    </div>
                                    <div class="role-actions">
                                        <p:button icon="pi pi-pencil" title="Edit role"
                                                  styleClass="ui-button-info p-button-sm"
                                                  outcome="/pages/users/RoleForm.xhtml">
                                            <f:param name="id" value="#{model.id}"/>
                                        </p:button>

                                        <p:commandButton icon="pi pi-trash" title="Delete role"
                                                         styleClass="ui-button-danger p-button-sm"
                                                         actionListener="#{rolesView.deleteSelectedRole(model)}"
                                                         update="rolesViewForm">
                                            <p:confirm header="Confirmation"
                                                       message="You are about to delete the role '#{model.name}'. Are you sure?"
                                                       icon="pi pi-exclamation-triangle" />
                                        </p:commandButton>
                                    </div>
                                </div>
                            </ui:repeat>
                        </div>
                    </h:panelGroup>

                    <!-- Empty State -->
                    <h:panelGroup rendered="#{empty rolesView.dataModels}">
                        <div class="empty-state">
                            <div class="empty-state-icon">
                                <i class="pi pi-shield"></i>
                            </div>
                            <div>No roles found.</div>
                        </div>
                    </h:panelGroup>
                </h:panelGroup>

                <!-- Add New Role Section -->
                <div class="add-role-section">
                    <div class="add-role-card">
                        <div class="add-role-text">Create a new role to define user access</div>
                        <p:button value="Add New Role" icon="pi pi-plus"
                                  outcome="/pages/users/RoleForm.xhtml"
                                  styleClass="ui-button-success" />
                    </div>
                </div>

            </div>

            <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                <p:commandButton value="Yes" type="button" styleClass="ui-confirmdialog-yes" icon="pi pi-check" />
                <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no ui-button-secondary" icon="pi pi-times" />
            </p:confirmDialog>
        </h:form>
    </ui:define>
</ui:composition>